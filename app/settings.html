<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings â€¢ Mandarin Flashcards</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>Settings</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="study.html">Study</a>
      <a href="add.html">Add Card</a>
      <a href="settings.html" aria-current="page">Settings</a>
    </nav>
  </header>

  <main>
    <form id="settings-form" class="card-form">
      <label>Theme
        <select name="theme">
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="system">System</option>
        </select>
      </label>
      <label>Tone colors (comma separated hex)
        <input type="text" name="toneColors" placeholder="#e74c3c,#f39c12,#27ae60,#2980b9,#95a5a6" />
      </label>
      <button type="submit" class="primary">Save Settings</button>
      <p id="settings-status" class="hint"></p>
    </form>
  </main>

  <script src="app.js" type="module"></script>
  <script type="module">
    import { MandarinApp } from './app.js';

    const form = document.getElementById('settings-form');
    const statusEl = document.getElementById('settings-status');

    MandarinApp.ready(async () => {
      const settings = await MandarinApp.getSettings();
      form.theme.value = settings.theme || 'light';
      form.toneColors.value = (settings.toneColors || []).join(',');
    });

    form.addEventListener('submit', async (event) => {
      event.preventDefault();
      const data = new FormData(form);
      await MandarinApp.saveSettings({
        theme: data.get('theme'),
        toneColors: (data.get('toneColors') || '').split(',').map(c => c.trim()).filter(Boolean)
      });
      statusEl.textContent = 'Settings saved.';
      setTimeout(() => (statusEl.textContent = ''), 2500);
    });
  </script>
</body>
</html>
